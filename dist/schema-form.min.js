(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("angular"),require("objectpath"),require("tv4"));else if(typeof define==="function"&&define.amd)define(["angular","objectpath","tv4"],factory);else{var a=typeof exports==="object"?factory(require("angular"),require("objectpath"),require("tv4")):factory(root["angular"],root["objectpath"],root["tv4"]);for(var i in a)(typeof exports==="object"?exports:root)[i]=a[i]}})(this,function(__WEBPACK_EXTERNAL_MODULE_2__,__WEBPACK_EXTERNAL_MODULE_9__,__WEBPACK_EXTERNAL_MODULE_11__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){"use strict";var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);var _builder=__webpack_require__(3);var _builder2=_interopRequireDefault(_builder);var _decorators=__webpack_require__(4);var _decorators2=_interopRequireDefault(_decorators);var _errors=__webpack_require__(5);var _errors2=_interopRequireDefault(_errors);var _schemaForm=__webpack_require__(6);var _schemaForm2=_interopRequireDefault(_schemaForm);var _select=__webpack_require__(7);var _select2=_interopRequireDefault(_select);var _sfPath=__webpack_require__(8);var _sfPath2=_interopRequireDefault(_sfPath);var _validator=__webpack_require__(10);var _validator2=_interopRequireDefault(_validator);var _array=__webpack_require__(12);var _array2=_interopRequireDefault(_array);var _changed=__webpack_require__(13);var _changed2=_interopRequireDefault(_changed);var _field=__webpack_require__(14);var _field2=_interopRequireDefault(_field);var _message=__webpack_require__(15);var _message2=_interopRequireDefault(_message);var _newArray=__webpack_require__(16);var _newArray2=_interopRequireDefault(_newArray);var _schemaForm3=__webpack_require__(17);var _schemaForm4=_interopRequireDefault(_schemaForm3);var _schemaValidate=__webpack_require__(18);var _schemaValidate2=_interopRequireDefault(_schemaValidate);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var deps=[];try{_angular2.default.module("ngSanitize");deps.push("ngSanitize")}catch(e){}try{_angular2.default.module("ui.sortable");deps.push("ui.sortable")}catch(e){}try{_angular2.default.module("angularSpectrumColorpicker");deps.push("angularSpectrumColorpicker")}catch(e){}_angular2.default.module("schemaForm",deps).provider("sfPath",_sfPath2.default).provider("sfBuilder",["sfPathProvider",builder]).provider("schemaFormDecorators",["$compileProvider","sfPathProvider",_decorators2.default]).provider("sfErrorMessage",_errors2.default).provider("schemaForm",["sfPathProvider",_schemaForm2.default]).factory("sfSelect",["sfPath",_select2.default]).factory("sfValidator",_validator2.default).directive("sfArray",["sfSelect","schemaForm","sfValidator","sfPath",_array2.default]).directive("sfChanged",_changed2.default).directive("sfField",["$parse","$compile","$http","$templateCache","$interpolate","$q","sfErrorMessage","sfPath","sfSelect",_field2.default]).directive("sfMessage",["$injector","sfErrorMessage",_message2.default]).directive("sfNewArray",["sfSelect","sfPath","schemaForm",_newArray2.default]).directive("sfSchema",["$compile","$http","$templateCache","$q","schemaForm","schemaFormDecorators","sfSelect","sfPath","sfBuilder",_schemaForm4.default]).directive("schemaValidate",["sfValidator","$parse","sfSelect",_schemaValidate2.default])},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_2__},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(sfPathProvider){var SNAKE_CASE_REGEXP=/[A-Z]/g;var snakeCase=function snakeCase(name,separator){separator=separator||"_";return name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})};var formId=0;var builders={sfField:function sfField(args){args.fieldFrag.firstChild.setAttribute("sf-field",formId);args.lookup["f"+formId]=args.form;formId++},ngModel:function ngModel(args){if(!args.form.key){return}var key=args.form.key;if(args.state.keyRedaction){key=key.slice(args.state.keyRedaction)}var modelValue;if(!args.state.modelValue){var strKey=sfPathProvider.stringify(key).replace(/"/g,"&quot;");modelValue=args.state.modelName||"model";if(strKey){modelValue+=(strKey[0]!=="["?".":"")+strKey}}else{modelValue=args.state.modelValue}var nodes=args.fieldFrag.querySelectorAll("[sf-field-model]");for(var i=0;i<nodes.length;i++){var n=nodes[i];var conf=n.getAttribute("sf-field-model");if(!conf||conf===""){n.setAttribute("ng-model",modelValue)}else if(conf==="replaceAll"){var attributes=n.attributes;for(var j=0;j<attributes.length;j++){if(attributes[j].value&&attributes[j].value.indexOf("$$value")!==-1){attributes[j].value=attributes[j].value.replace(/\$\$value\$\$/g,modelValue)}}}else{var val=n.getAttribute(conf);if(val&&val.indexOf("$$value$$")){n.setAttribute(conf,val.replace(/\$\$value\$\$/g,modelValue))}else{n.setAttribute(conf,modelValue)}}}},simpleTransclusion:function simpleTransclusion(args){var children=args.build(args.form.items,args.path+".items",args.state);args.fieldFrag.firstChild.appendChild(children)},ngModelOptions:function ngModelOptions(args){if(args.form.ngModelOptions&&Object.keys(args.form.ngModelOptions).length>0){args.fieldFrag.firstChild.setAttribute("ng-model-options",JSON.stringify(args.form.ngModelOptions))}},transclusion:function transclusion(args){var transclusions=args.fieldFrag.querySelectorAll("[sf-field-transclude]");if(transclusions.length){for(var i=0;i<transclusions.length;i++){var n=transclusions[i];var sub=n.getAttribute("sf-field-transclude")||"items";var items=args.form[sub];if(items){var childFrag=args.build(items,args.path+"."+sub,args.state);n.appendChild(childFrag)}}}},condition:function condition(args){if(args.form.condition){var evalExpr="evalExpr("+args.path+'.condition, { model: model, "arrayIndex": $index})';if(args.form.key){var strKey=sfPathProvider.stringify(args.form.key);evalExpr="evalExpr("+args.path+'.condition,{ model: model, "arrayIndex": $index, '+'"modelValue": model'+(strKey[0]==="["?"":".")+strKey+"})"}var children=args.fieldFrag.children||args.fieldFrag.childNodes;for(var i=0;i<children.length;i++){var child=children[i];var ngIf=child.getAttribute("ng-if");child.setAttribute("ng-if",ngIf?"("+ngIf+") || ("+evalExpr+")":evalExpr)}}},array:function array(args){var items=args.fieldFrag.querySelector("[schema-form-array-items]");if(items){state=angular.copy(args.state);state.keyRedaction=state.keyRedaction||0;state.keyRedaction+=args.form.key.length+1;if(args.form.schema&&args.form.schema.items&&args.form.schema.items.type&&args.form.schema.items.type.indexOf("object")===-1&&args.form.schema.items.type.indexOf("array")===-1){var strKey=sfPathProvider.stringify(args.form.key).replace(/"/g,"&quot;")+"[$index]";state.modelValue="modelArray[$index]"}else{state.modelName="item"}state.arrayCompatFlag=true;var childFrag=args.build(args.form.items,args.path+".items",state);items.appendChild(childFrag)}}};this.builders=builders;var stdBuilders=[builders.sfField,builders.ngModel,builders.ngModelOptions,builders.condition];this.stdBuilders=stdBuilders;this.$get=["$templateCache","schemaFormDecorators","sfPath",function($templateCache,schemaFormDecorators,sfPath){var checkForSlot=function checkForSlot(form,slots){if(form.key){var slot=slots[sfPath.stringify(form.key)];if(slot){while(slot.firstChild){slot.removeChild(slot.firstChild)}return slot}}};var _build=function _build(items,decorator,templateFn,slots,path,state,lookup){state=state||{};lookup=lookup||Object.create(null);path=path||"schemaForm.form";var container=document.createDocumentFragment();items.reduce(function(frag,f,index){if(!f.type){return frag}var field=decorator[f.type]||decorator["default"];if(!field.replace){var n=document.createElement(snakeCase(decorator.__name,"-"));if(state.arrayCompatFlag){n.setAttribute("form","copyWithIndex($index)")}else{n.setAttribute("form",path+"["+index+"]")}(checkForSlot(f,slots)||frag).appendChild(n)}else{var tmpl;state.arrayCompatFlag=false;var div=document.createElement("div");var template=templateFn(f,field)||templateFn(f,decorator["default"]);div.innerHTML=template;tmpl=document.createDocumentFragment();while(div.childNodes.length>0){tmpl.appendChild(div.childNodes[0])}var args={fieldFrag:tmpl,form:f,lookup:lookup,state:state,path:path+"["+index+"]",build:function build(items,path,state){return _build(items,decorator,templateFn,slots,path,state,lookup)}};var builderFn=f.builder||field.builder;if(typeof builderFn==="function"){builderFn(args)}else{builderFn.forEach(function(fn){fn(args)})}(checkForSlot(f,slots)||frag).appendChild(tmpl)}return frag},container);return container};return{build:function build(form,decorator,slots,lookup){return _build(form,decorator,function(form,field){if(form.type==="template"){return form.template}return $templateCache.get(field.template)},slots,undefined,undefined,lookup)},builder:builders,stdBuilders:stdBuilders,internalBuild:_build}}]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function($compileProvider,sfPathProvider){var defaultDecorator="";var decorators={};var templateUrl=function templateUrl(name,form){if(name==="sfDecorator"){name=defaultDecorator}var decorator=decorators[name];if(decorator[form.type]){return decorator[form.type].template}return decorator["default"].template};var createDirective=function createDirective(name){$compileProvider.directive(name,["$parse","$compile","$http","$templateCache","$interpolate","$q","sfErrorMessage","sfPath","sfSelect",function($parse,$compile,$http,$templateCache,$interpolate,$q,sfErrorMessage,sfPath,sfSelect){return{restrict:"AE",replace:false,transclude:false,scope:true,require:"?^sfSchema",link:function link(scope,element,attrs,sfSchema){scope.$on("schemaFormPropagateNgModelController",function(event,ngModel){event.stopPropagation();event.preventDefault();scope.ngModel=ngModel});scope.showTitle=function(){return scope.form&&scope.form.notitle!==true&&scope.form.title};scope.listToCheckboxValues=function(list){var values={};_angular2.default.forEach(list,function(v){values[v]=true});return values};scope.checkboxValuesToList=function(values){var lst=[];_angular2.default.forEach(values,function(v,k){if(v){lst.push(k)}});return lst};scope.buttonClick=function($event,form){if(_angular2.default.isFunction(form.onClick)){form.onClick($event,form)}else if(_angular2.default.isString(form.onClick)){if(sfSchema){sfSchema.evalInParentScope(form.onClick,{$event:$event,form:form})}else{scope.$eval(form.onClick,{$event:$event,form:form})}}};scope.evalExpr=function(expression,locals){if(sfSchema){return sfSchema.evalInParentScope(expression,locals)}return scope.$eval(expression,locals)};scope.evalInScope=function(expression,locals){if(expression){return scope.$eval(expression,locals)}};scope.interp=function(expression,locals){return expression&&$interpolate(expression)(locals)};scope.hasSuccess=function(){if(!scope.ngModel){return false}return scope.ngModel.$valid&&(!scope.ngModel.$pristine||!scope.ngModel.$isEmpty(scope.ngModel.$modelValue))};scope.hasError=function(){if(!scope.ngModel){return false}return scope.ngModel.$invalid&&!scope.ngModel.$pristine};scope.errorMessage=function(schemaError){return sfErrorMessage.interpolate(schemaError&&schemaError.code+""||"default",scope.ngModel&&scope.ngModel.$modelValue||"",scope.ngModel&&scope.ngModel.$viewValue||"",scope.form,scope.options&&scope.options.validationMessage)};var once=scope.$watch(attrs.form,function(form){if(form){form.ngModelOptions=form.ngModelOptions||{};scope.form=form;var templatePromise;if(form.type==="template"&&form.template){templatePromise=$q.when(form.template)}else{var url=form.type==="template"?form.templateUrl:templateUrl(name,form);templatePromise=$http.get(url,{cache:$templateCache}).then(function(res){return res.data})}templatePromise.then(function(template){if(form.key){var key=form.key?sfPathProvider.stringify(form.key).replace(/"/g,"&quot;"):"";template=template.replace(/\$\$value\$\$/g,"model"+(key[0]!=="["?".":"")+key)}element.html(template);if(form.condition){var evalExpr='evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex})';if(form.key){evalExpr='evalExpr(form.condition,{ model: model, "arrayIndex": arrayIndex, "modelValue": model'+sfPath.stringify(form.key)+"})"}_angular2.default.forEach(element.children(),function(child){var ngIf=child.getAttribute("ng-if");child.setAttribute("ng-if",ngIf?"("+ngIf+") || ("+evalExpr+")":evalExpr)})}$compile(element.contents())(scope)});if(form.key){scope.$on("schemaForm.error."+form.key.join("."),function(event,error,validationMessage,validity){if(validationMessage===true||validationMessage===false){validity=validationMessage;validationMessage=undefined}if(scope.ngModel&&error){if(scope.ngModel.$setDirty){scope.ngModel.$setDirty()}else{scope.ngModel.$dirty=true;scope.ngModel.$pristine=false}if(validationMessage){if(!form.validationMessage){form.validationMessage={}}form.validationMessage[error]=validationMessage}scope.ngModel.$setValidity(error,validity===true);if(validity===true){scope.$broadcast("schemaFormValidate")}}});scope.$on("$destroy",function(){if(!scope.externalDestructionInProgress){var destroyStrategy=form.destroyStrategy||scope.options&&scope.options.destroyStrategy||"remove";if(form.key&&destroyStrategy!=="retain"){var obj=scope.model;if(form.key.length>1){obj=sfSelect(form.key.slice(0,form.key.length-1),obj)}if(obj===undefined){return}var type=form.schema&&form.schema.type||"";if(destroyStrategy==="empty"&&type.indexOf("string")!==-1){obj[form.key.slice(-1)]=""}else if(destroyStrategy==="empty"&&type.indexOf("object")!==-1){obj[form.key.slice(-1)]={}}else if(destroyStrategy==="empty"&&type.indexOf("array")!==-1){obj[form.key.slice(-1)]=[]}else if(destroyStrategy==="null"){obj[form.key.slice(-1)]=null}else{delete obj[form.key.slice(-1)]}}}})}once()}})}}}])};var createManualDirective=function createManualDirective(type,templateUrl,transclude){transclude=_angular2.default.isDefined(transclude)?transclude:false;$compileProvider.directive("sf"+_angular2.default.uppercase(type[0])+type.substr(1),function(){return{restrict:"EAC",scope:true,replace:true,transclude:transclude,template:'<sf-decorator form="form"></sf-decorator>',link:function link(scope,element,attrs){var watchThis={items:"c",titleMap:"c",schema:"c"};var form={type:type};var once=true;_angular2.default.forEach(attrs,function(value,name){if(name[0]!=="$"&&name.indexOf("ng")!==0&&name!=="sfField"){var updateForm=function updateForm(val){if(_angular2.default.isDefined(val)&&val!==form[name]){form[name]=val;if(once&&form.type&&(form.key||_angular2.default.isUndefined(attrs.key))){scope.form=form;once=false}}};if(name==="model"){scope.$watch(value,function(val){if(val&&scope.model!==val){scope.model=val}})}else if(watchThis[name]==="c"){scope.$watchCollection(value,updateForm)}else{attrs.$observe(name,updateForm)}}})}}})};this.createDecorator=function(name,templates){decorators[name]={__name:name};_angular2.default.forEach(templates,function(url,type){decorators[name][type]={template:url,replace:false,builder:[]}});if(!decorators[defaultDecorator]){defaultDecorator=name}createDirective(name)};this.defineDecorator=function(name,fields){decorators[name]={__name:name};_angular2.default.forEach(fields,function(field,type){field.builder=field.builder||[];field.replace=_angular2.default.isDefined(field.replace)?field.replace:true;decorators[name][type]=field});if(!decorators[defaultDecorator]){defaultDecorator=name}createDirective(name)};this.createDirective=createManualDirective;this.createDirectives=function(templates){_angular2.default.forEach(templates,function(url,type){createManualDirective(type,url)})};this.decorator=function(name){name=name||defaultDecorator;return decorators[name]};this.addMapping=function(name,type,url,builder,replace){if(decorators[name]){decorators[name][type]={template:url,builder:builder,replace:!!replace}}};this.defineAddOn=function(name,type,url,builder){if(decorators[name]){decorators[name][type]={template:url,builder:builder,replace:true}}};this.$get=function(){return{decorator:function decorator(name){return decorators[name]||decorators[defaultDecorator]},defaultDecorator:defaultDecorator}};createDirective("sfDecorator")};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(){var defaultMessages={"default":"Field does not validate",0:"Invalid type, expected {{schema.type}}",1:"No enum match for: {{viewValue}}",10:'Data does not match any schemas from "anyOf"',11:'Data does not match any schemas from "oneOf"',12:'Data is valid against more than one schema from "oneOf"',13:'Data matches schema from "not"',100:"Value is not a multiple of {{schema.multipleOf}}",101:"{{viewValue}} is less than the allowed minimum of {{schema.minimum}}",102:"{{viewValue}} is equal to the exclusive minimum {{schema.minimum}}",103:"{{viewValue}} is greater than the allowed maximum of {{schema.maximum}}",104:"{{viewValue}} is equal to the exclusive maximum {{schema.maximum}}",105:"Value is not a valid number",200:"String is too short ({{viewValue.length}} chars), minimum {{schema.minLength}}",201:"String is too long ({{viewValue.length}} chars), maximum {{schema.maxLength}}",202:"String does not match pattern: {{schema.pattern}}",300:"Too few properties defined, minimum {{schema.minProperties}}",301:"Too many properties defined, maximum {{schema.maxProperties}}",302:"Required",303:"Additional properties not allowed",304:"Dependency failed - key must exist",400:"Array is too short ({{value.length}}), minimum {{schema.minItems}}",401:"Array is too long ({{value.length}}), maximum {{schema.maxItems}}",402:"Array items are not unique",403:"Additional items not allowed",500:"Format validation failed",501:'Keyword failed: "{{title}}"',600:"Circular $refs",1e3:"Unknown property (not in schema)"};defaultMessages.number=defaultMessages[105];defaultMessages.required=defaultMessages[302];defaultMessages.min=defaultMessages[101];defaultMessages.max=defaultMessages[103];defaultMessages.maxlength=defaultMessages[201];defaultMessages.minlength=defaultMessages[200];defaultMessages.pattern=defaultMessages[202];this.setDefaultMessages=function(messages){defaultMessages=messages};this.getDefaultMessages=function(){return defaultMessages};this.setDefaultMessage=function(error,msg){defaultMessages[error]=msg};this.$get=["$interpolate",function($interpolate){var service={};service.defaultMessages=defaultMessages;service.interpolate=function(error,value,viewValue,form,global){global=global||{};var validationMessage=form.validationMessage||{};if(error.indexOf("tv4-")===0){error=error.substring(4)}var message=validationMessage["default"]||global["default"]||"";[validationMessage,global,defaultMessages].some(function(val){if(_angular2.default.isString(val)||_angular2.default.isFunction(val)){message=val;return true}if(val&&val[error]){message=val[error];return true}});var context={error:error,value:value,viewValue:viewValue,form:form,schema:form.schema,title:form.title||form.schema&&form.schema.title};if(_angular2.default.isFunction(message)){return message(context)}else{return $interpolate(message)(context)}};return service}]};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(sfPathProvider){var stripNullType=function stripNullType(type){if(Array.isArray(type)&&type.length==2){if(type[0]==="null")return type[1];if(type[1]==="null")return type[0]}return type};var enumToTitleMap=function enumToTitleMap(enm){var titleMap=[];enm.forEach(function(name){titleMap.push({name:name,value:name})});return titleMap};var canonicalTitleMap=function canonicalTitleMap(titleMap,originalEnum){if(!_angular2.default.isArray(titleMap)){var canonical=[];if(originalEnum){_angular2.default.forEach(originalEnum,function(value,index){canonical.push({name:titleMap[value],value:value})})}else{_angular2.default.forEach(titleMap,function(name,value){canonical.push({name:name,value:value})})}return canonical}return titleMap};var defaultFormDefinition=function defaultFormDefinition(name,schema,options){var rules=defaults[stripNullType(schema.type)];if(rules){var def;for(var i=0;i<rules.length;i++){def=rules[i](name,schema,options);if(def){if(def.schema["x-schema-form"]&&_angular2.default.isObject(def.schema["x-schema-form"])){def=_angular2.default.extend(def,def.schema["x-schema-form"])}return def}}}};var stdFormObj=function stdFormObj(name,schema,options){options=options||{};var f=options.global&&options.global.formDefaults?_angular2.default.copy(options.global.formDefaults):{};if(options.global&&options.global.supressPropertyTitles===true){f.title=schema.title}else{f.title=schema.title||name}if(schema.description){f.description=schema.description}if(options.required===true||schema.required===true){f.required=true}if(schema.maxLength){f.maxlength=schema.maxLength}if(schema.minLength){f.minlength=schema.minLength}if(schema.readOnly||schema.readonly){f.readonly=true}if(schema.minimum){f.minimum=schema.minimum+(schema.exclusiveMinimum?1:0)}if(schema.maximum){f.maximum=schema.maximum-(schema.exclusiveMaximum?1:0)}if(schema.validationMessage){f.validationMessage=schema.validationMessage}if(schema.enumNames){f.titleMap=canonicalTitleMap(schema.enumNames,schema["enum"])}f.schema=schema;f.ngModelOptions=f.ngModelOptions||{};return f};var text=function text(name,schema,options){if(stripNullType(schema.type)==="string"&&!schema["enum"]){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="text";options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var number=function number(name,schema,options){if(stripNullType(schema.type)==="number"){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="number";options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var integer=function integer(name,schema,options){if(stripNullType(schema.type)==="integer"){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="number";options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var checkbox=function checkbox(name,schema,options){if(stripNullType(schema.type)==="boolean"){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="checkbox";options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var select=function select(name,schema,options){if(stripNullType(schema.type)==="string"&&schema["enum"]){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="select";if(!f.titleMap){f.titleMap=enumToTitleMap(schema["enum"])}options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var checkboxes=function checkboxes(name,schema,options){if(stripNullType(schema.type)==="array"&&schema.items&&schema.items["enum"]){var f=stdFormObj(name,schema,options);f.key=options.path;f.type="checkboxes";if(!f.titleMap){f.titleMap=enumToTitleMap(schema.items["enum"])}options.lookup[sfPathProvider.stringify(options.path)]=f;return f}};var fieldset=function fieldset(name,schema,options){if(stripNullType(schema.type)==="object"){var f=stdFormObj(name,schema,options);f.type="fieldset";f.items=[];options.lookup[sfPathProvider.stringify(options.path)]=f;_angular2.default.forEach(schema.properties,function(v,k){var path=options.path.slice();path.push(k);if(options.ignore[sfPathProvider.stringify(path)]!==true){var required=schema.required&&schema.required.indexOf(k)!==-1;var def=defaultFormDefinition(k,v,{path:path,required:required||false,lookup:options.lookup,ignore:options.ignore,global:options.global});if(def){f.items.push(def)}}});return f}};var array=function array(name,schema,options){if(stripNullType(schema.type)==="array"){var f=stdFormObj(name,schema,options);f.type="array";f.key=options.path;options.lookup[sfPathProvider.stringify(options.path)]=f;var required=schema.required&&schema.required.indexOf(options.path[options.path.length-1])!==-1;var arrPath=options.path.slice();arrPath.push("");f.items=[defaultFormDefinition(name,schema.items,{path:arrPath,required:required||false,lookup:options.lookup,ignore:options.ignore,global:options.global})];return f}};var defaults={string:[select,text],object:[fieldset],number:[number],integer:[integer],"boolean":[checkbox],array:[checkboxes,array]};var postProcessFn=function postProcessFn(form){return form};this.defaults=defaults;this.stdFormObj=stdFormObj;this.defaultFormDefinition=defaultFormDefinition;this.postProcess=function(fn){postProcessFn=fn};this.appendRule=function(type,rule){if(!defaults[type]){defaults[type]=[]}defaults[type].push(rule)};this.prependRule=function(type,rule){if(!defaults[type]){defaults[type]=[]}defaults[type].unshift(rule)};this.createStandardForm=stdFormObj;this.$get=function(){var service={};service.merge=function(schema,form,ignore,options,readonly,asyncTemplates){form=form||["*"];options=options||{};readonly=readonly||schema.readonly||schema.readOnly;var stdForm=service.defaults(schema,ignore,options);var idx=form.indexOf("*");if(idx!==-1){form=form.slice(0,idx).concat(stdForm.form).concat(form.slice(idx+1))}var lookup=stdForm.lookup;return postProcessFn(form.map(function(obj){if(typeof obj==="string"){obj={key:obj}}if(obj.key){if(typeof obj.key==="string"){obj.key=sfPathProvider.parse(obj.key)}}if(obj.titleMap){obj.titleMap=canonicalTitleMap(obj.titleMap)}if(obj.itemForm){obj.items=[];var str=sfPathProvider.stringify(obj.key);var stdForm=lookup[str];_angular2.default.forEach(stdForm.items,function(item){var o=_angular2.default.copy(obj.itemForm);o.key=item.key;obj.items.push(o)})}if(obj.key){var strid=sfPathProvider.stringify(obj.key);if(lookup[strid]){var schemaDefaults=lookup[strid];_angular2.default.forEach(schemaDefaults,function(value,attr){if(obj[attr]===undefined){obj[attr]=schemaDefaults[attr]}})}}if(readonly===true){obj.readonly=true}if(obj.items){obj.items=service.merge(schema,obj.items,ignore,options,obj.readonly,asyncTemplates)}if(obj.tabs){_angular2.default.forEach(obj.tabs,function(tab){tab.items=service.merge(schema,tab.items,ignore,options,obj.readonly,asyncTemplates)})}if(obj.type==="checkbox"&&_angular2.default.isUndefined(obj.schema["default"])){obj.schema["default"]=false}if(asyncTemplates&&obj.type==="template"&&!obj.template&&obj.templateUrl){asyncTemplates.push(obj)}return obj}))};service.defaults=function(schema,ignore,globalOptions){var form=[];var lookup={};ignore=ignore||{};globalOptions=globalOptions||{};if(stripNullType(schema.type)==="object"){_angular2.default.forEach(schema.properties,function(v,k){if(ignore[k]!==true){var required=schema.required&&schema.required.indexOf(k)!==-1;var def=defaultFormDefinition(k,v,{path:[k],lookup:lookup,ignore:ignore,required:required,global:globalOptions});if(def){form.push(def)}}})}else{throw new Error('Not implemented. Only type "object" allowed at root level of schema.')}return{form:form,lookup:lookup}};service.traverseSchema=function(schema,fn,path,ignoreArrays){ignoreArrays=_angular2.default.isDefined(ignoreArrays)?ignoreArrays:true;path=path||[];var traverse=function traverse(schema,fn,path){fn(schema,path);_angular2.default.forEach(schema.properties,function(prop,name){var currentPath=path.slice();currentPath.push(name);traverse(prop,fn,currentPath)});if(!ignoreArrays&&schema.items){var arrPath=path.slice();arrPath.push("");traverse(schema.items,fn,arrPath)}};traverse(schema,fn,path||[])};service.traverseForm=function(form,fn){fn(form);_angular2.default.forEach(form.items,function(f){service.traverseForm(f,fn)});if(form.tabs){_angular2.default.forEach(form.tabs,function(tab){_angular2.default.forEach(tab.items,function(f){service.traverseForm(f,fn)})})}};return service}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports){"use strict";angular.module("schemaForm").factory("sfSelect",["sfPath",function(sfPath){var numRe=/^\d+$/;return function(projection,obj,valueToSet){if(!obj){obj=this}var parts=typeof projection==="string"?sfPath.parse(projection):projection;if(typeof valueToSet!=="undefined"&&parts.length===1){obj[parts[0]]=valueToSet;return obj}if(typeof valueToSet!=="undefined"&&typeof obj[parts[0]]==="undefined"){obj[parts[0]]=parts.length>2&&numRe.test(parts[1])?[]:{}}var value=obj[parts[0]];for(var i=1;i<parts.length;i++){if(parts[i]===""){return undefined}if(typeof valueToSet!=="undefined"){if(i===parts.length-1){value[parts[i]]=valueToSet;return valueToSet}else{var tmp=value[parts[i]];if(typeof tmp==="undefined"||tmp===null){tmp=numRe.test(parts[i+1])?[]:{};value[parts[i]]=tmp}value=tmp}}else if(value){value=value[parts[i]]}}return value}}])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(){var sfPath={parse:_objectpath2.default.parse};if(_angular2.default.version.major===1&&_angular2.default.version.minor<3){sfPath.stringify=function(arr){return Array.isArray(arr)?arr.join("."):arr.toString()}}else{sfPath.stringify=_objectpath2.default.stringify}sfPath.normalize=function(data,quote){return sfPath.stringify(Array.isArray(data)?data:sfPath.parse(data),quote)};this.parse=sfPath.parse;this.stringify=sfPath.stringify;this.normalize=sfPath.normalize;this.$get=function(){return sfPath}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);var _objectpath=__webpack_require__(9);var _objectpath2=_interopRequireDefault(_objectpath);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_9__},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(){var validator={};validator.validate=function(form,value){if(!form){return{valid:true}}var schema=form.schema;if(!schema){return{valid:true}}if(value===""){value=undefined}if(form.type==="number"&&value===null){value=undefined}var wrap={type:"object",properties:{}};var propName=form.key[form.key.length-1];wrap.properties[propName]=schema;if(form.required){wrap.required=[propName]}var valueWrap={};if(_angular2.default.isDefined(value)){valueWrap[propName]=value}return _tv2.default.validateResult(valueWrap,wrap)};return validator};var _tv=__webpack_require__(11);var _tv2=_interopRequireDefault(_tv);var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_11__},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(sfSelect,schemaForm,sfValidator,sfPath){var setIndex=function setIndex(index){
return function(form){if(form.key){form.key[form.key.indexOf("")]=index}}};return{restrict:"A",scope:true,require:"?ngModel",link:function link(scope,element,attrs,ngModel){var formDefCache={};scope.validateArray=_angular2.default.noop;if(ngModel){scope.$emit("schemaFormPropagateNgModelController",ngModel)}var once=scope.$watch(attrs.sfArray,function(form){if(!form){return}var list=sfSelect(form.key,scope.model);var key=sfPath.normalize(form.key);scope.$watch("model"+(key[0]!=="["?".":"")+key,function(value){list=scope.modelArray=value});if(_angular2.default.isUndefined(list)){list=[];sfSelect(form.key,scope.model,list)}scope.modelArray=list;if(form.items){var subForm=form.items[0];if(form.items.length>1){subForm={type:"section",items:form.items.map(function(item){item.ngModelOptions=form.ngModelOptions;if(_angular2.default.isUndefined(item.readonly)){item.readonly=form.readonly}return item})}}}scope.copyWithIndex=function(index){if(!formDefCache[index]){if(subForm){var copy=_angular2.default.copy(subForm);copy.arrayIndex=index;schemaForm.traverseForm(copy,setIndex(index));formDefCache[index]=copy}}return formDefCache[index]};scope.appendToArray=function(){var len=list.length;var copy=scope.copyWithIndex(len);schemaForm.traverseForm(copy,function(part){if(part.key){var def;if(_angular2.default.isDefined(part["default"])){def=part["default"]}if(_angular2.default.isDefined(part.schema)&&_angular2.default.isDefined(part.schema["default"])){def=part.schema["default"]}if(_angular2.default.isDefined(def)){sfSelect(part.key,scope.model,def)}}});if(len===list.length){var type=sfSelect("schema.items.type",form);var dflt;if(type==="object"){dflt={}}else if(type==="array"){dflt=[]}list.push(dflt)}scope.validateArray();return list};scope.deleteFromArray=function(index){list.splice(index,1);scope.validateArray();if(ngModel&&ngModel.$setDirty){ngModel.$setDirty()}return list};if(!form.titleMap&&form.startEmpty!==true&&list.length===0){scope.appendToArray()}if(form.titleMap&&form.titleMap.length>0){scope.titleMapValues=[];var updateTitleMapValues=function updateTitleMapValues(arr){scope.titleMapValues=[];arr=arr||[];form.titleMap.forEach(function(item){scope.titleMapValues.push(arr.indexOf(item.value)!==-1)})};updateTitleMapValues(scope.modelArray);scope.$watchCollection("modelArray",updateTitleMapValues);scope.$watchCollection("titleMapValues",function(vals,old){if(vals&&vals!==old){var arr=scope.modelArray;while(arr.length>0){arr.pop()}form.titleMap.forEach(function(item,index){if(vals[index]){arr.push(item.value)}});scope.validateArray()}})}if(ngModel){var error;scope.validateArray=function(){var result=sfValidator.validate(form,scope.modelArray.length>0?scope.modelArray:undefined);Object.keys(ngModel.$error).filter(function(k){return k.indexOf("tv4-")===0}).forEach(function(k){ngModel.$setValidity(k,true)});if(result.valid===false&&result.error&&(result.error.dataPath===""||result.error.dataPath==="/"+form.key[form.key.length-1])){ngModel.$setViewValue(scope.modelArray);error=result.error;ngModel.$setValidity("tv4-"+result.error.code,false)}};scope.$on("schemaFormValidate",scope.validateArray);scope.hasSuccess=function(){if(scope.options&&scope.options.pristine&&scope.options.pristine.success===false){return ngModel.$valid&&!ngModel.$pristine&&!ngModel.$isEmpty(ngModel.$modelValue)}else{return ngModel.$valid&&(!ngModel.$pristine||!ngModel.$isEmpty(ngModel.$modelValue))}};scope.hasError=function(){if(!scope.options||!scope.options.pristine||scope.options.pristine.errors!==false){return ngModel.$invalid}else{return ngModel.$invalid&&!ngModel.$pristine}};scope.schemaError=function(){return error}}once()})}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(){return{require:"ngModel",restrict:"AC",scope:false,link:function link(scope,element,attrs,ctrl){var form=scope.$eval(attrs.sfChanged);if(form&&form.onChange){ctrl.$viewChangeListeners.push(function(){if(_angular2.default.isFunction(form.onChange)){form.onChange(ctrl.$modelValue,form)}else{scope.evalExpr(form.onChange,{modelValue:ctrl.$modelValue,form:form})}})}}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function($parse,$compile,$http,$templateCache,$interpolate,$q,sfErrorMessage,sfPath,sfSelect){return{restrict:"AE",replace:false,transclude:false,scope:true,require:"^sfSchema",link:{pre:function pre(scope,element,attrs,sfSchema){scope.$on("schemaFormPropagateNgModelController",function(event,ngModel){event.stopPropagation();event.preventDefault();scope.ngModel=ngModel});scope.form=sfSchema.lookup["f"+attrs.sfField]},post:function post(scope,element,attrs,sfSchema){scope.showTitle=function(){return scope.form&&scope.form.notitle!==true&&scope.form.title};scope.listToCheckboxValues=function(list){var values={};_angular2.default.forEach(list,function(v){values[v]=true});return values};scope.checkboxValuesToList=function(values){var lst=[];_angular2.default.forEach(values,function(v,k){if(v){lst.push(k)}});return lst};scope.buttonClick=function($event,form){if(_angular2.default.isFunction(form.onClick)){form.onClick($event,form)}else if(_angular2.default.isString(form.onClick)){if(sfSchema){sfSchema.evalInParentScope(form.onClick,{$event:$event,form:form})}else{scope.$eval(form.onClick,{$event:$event,form:form})}}};scope.evalExpr=function(expression,locals){if(sfSchema){return sfSchema.evalInParentScope(expression,locals)}return scope.$eval(expression,locals)};scope.evalInScope=function(expression,locals){if(expression){return scope.$eval(expression,locals)}};scope.interp=function(expression,locals){return expression&&$interpolate(expression)(locals)};scope.hasSuccess=function(){if(!scope.ngModel){return false}if(scope.options&&scope.options.pristine&&scope.options.pristine.success===false){return scope.ngModel.$valid&&!scope.ngModel.$pristine&&!scope.ngModel.$isEmpty(scope.ngModel.$modelValue)}else{return scope.ngModel.$valid&&(!scope.ngModel.$pristine||!scope.ngModel.$isEmpty(scope.ngModel.$modelValue))}};scope.hasError=function(){if(!scope.ngModel){return false}if(!scope.options||!scope.options.pristine||scope.options.pristine.errors!==false){return scope.ngModel.$invalid}else{return scope.ngModel.$invalid&&!scope.ngModel.$pristine}};scope.errorMessage=function(schemaError){return sfErrorMessage.interpolate(schemaError&&schemaError.code+""||"default",scope.ngModel&&scope.ngModel.$modelValue||"",scope.ngModel&&scope.ngModel.$viewValue||"",scope.form,scope.options&&scope.options.validationMessage)};var form=scope.form;if(form.key){scope.$on("schemaForm.error."+form.key.join("."),function(event,error,validationMessage,validity){if(validationMessage===true||validationMessage===false){validity=validationMessage;validationMessage=undefined}if(scope.ngModel&&error){if(scope.ngModel.$setDirty){scope.ngModel.$setDirty()}else{scope.ngModel.$dirty=true;scope.ngModel.$pristine=false}if(validationMessage){if(!form.validationMessage){form.validationMessage={}}form.validationMessage[error]=validationMessage}scope.ngModel.$setValidity(error,validity===true);if(validity===true){scope.$broadcast("schemaFormValidate")}}});scope.$on("$destroy",function(){if(!scope.externalDestructionInProgress){var destroyStrategy=form.destroyStrategy||scope.options&&scope.options.destroyStrategy||"remove";if(form.key&&destroyStrategy!=="retain"){var obj=scope.model;if(form.key.length>1){obj=sfSelect(form.key.slice(0,form.key.length-1),obj)}if(obj===undefined){return}var type=form.schema&&form.schema.type||"";if(destroyStrategy==="empty"&&type.indexOf("string")!==-1){obj[form.key.slice(-1)]=""}else if(destroyStrategy==="empty"&&type.indexOf("object")!==-1){obj[form.key.slice(-1)]={}}else if(destroyStrategy==="empty"&&type.indexOf("array")!==-1){obj[form.key.slice(-1)]=[]}else if(destroyStrategy==="null"){obj[form.key.slice(-1)]=null}else{delete obj[form.key.slice(-1)]}}}})}}}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function($injector,sfErrorMessage){var $sanitize=$injector.has("$sanitize")?$injector.get("$sanitize"):function(html){return html};return{scope:false,restrict:"EA",link:function link(scope,element,attrs){var message="";if(attrs.sfMessage){scope.$watch(attrs.sfMessage,function(msg){if(msg){message=$sanitize(msg);update(!!scope.ngModel)}})}var currentMessage;var setMessage=function setMessage(msg){if(msg!==currentMessage){element.html(msg);currentMessage=msg}};var update=function update(checkForErrors){if(checkForErrors){if(!scope.hasError()){setMessage(message)}else{var errors=[];_angular2.default.forEach(scope.ngModel&&scope.ngModel.$error,function(status,code){if(status){errors.push(code)}});errors=errors.filter(function(e){return e!=="schemaForm"});var error=errors[0];if(error){setMessage(sfErrorMessage.interpolate(error,scope.ngModel.$modelValue,scope.ngModel.$viewValue,scope.form,scope.options&&scope.options.validationMessage))}else{setMessage(message)}}}else{setMessage(message)}};update();var once=scope.$watch("ngModel",function(ngModel){if(ngModel){ngModel.$parsers.push(function(val){update(true);return val});ngModel.$formatters.push(function(val){update(true);return val});once()}});scope.$watchCollection("ngModel.$error",function(){update(!!scope.ngModel)})}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(sel,sfPath,schemaForm){return{scope:false,link:function link(scope,element,attrs){scope.min=0;scope.modelArray=scope.$eval(attrs.sfNewArray);var watchFn=function watchFn(){scope.modelArray=scope.$eval(attrs.sfNewArray);if(scope.ngModel&&scope.ngModel.$pristine&&scope.firstDigest&&(!scope.options||scope.options.validateOnRender!==true)){return}else if(scope.validateField){scope.validateField()}};var onChangeFn=function onChangeFn(){if(scope.form&&scope.form.onChange){if(_angular2.default.isFunction(scope.form.onChange)){scope.form.onChange(scope.modelArray,scope.form)}else{scope.evalExpr(scope.form.onChange,{modelValue:scope.modelArray,form:scope.form})}}};var getOrCreateModel=function getOrCreateModel(){var model=scope.modelArray;if(!model){var selection=sfPath.parse(attrs.sfNewArray);model=[];sel(selection,scope,model);scope.modelArray=model}return model};var once=scope.$watch("form",function(form){if(!form){return}if(!form.titleMap&&form.startEmpty!==true&&(!scope.modelArray||scope.modelArray.length===0)){scope.appendToArray()}if(scope.form&&scope.form.schema&&scope.form.schema.uniqueItems===true){scope.$watch(attrs.sfNewArray,watchFn,true);scope.$watch([attrs.sfNewArray,attrs.sfNewArray+".length"],onChangeFn)}else{if(scope.$watchGroup){scope.$watchGroup([attrs.sfNewArray,attrs.sfNewArray+".length"],function(){watchFn();onChangeFn()})}else{scope.$watch(attrs.sfNewArray,function(){watchFn();onChangeFn()});scope.$watch(attrs.sfNewArray+".length",function(){watchFn();onChangeFn()})}}if(form.titleMap&&form.titleMap.length>0){scope.titleMapValues=[];var updateTitleMapValues=function updateTitleMapValues(arr){scope.titleMapValues=[];arr=arr||[];form.titleMap.forEach(function(item){scope.titleMapValues.push(arr.indexOf(item.value)!==-1)})};updateTitleMapValues(scope.modelArray);scope.$watchCollection("modelArray",updateTitleMapValues);scope.$watchCollection("titleMapValues",function(vals,old){if(vals&&vals!==old){var arr=getOrCreateModel();while(arr.length>0){arr.pop()}form.titleMap.forEach(function(item,index){if(vals[index]){arr.push(item.value)}});if(scope.validateField){scope.validateField()}}})}once()});scope.appendToArray=function(){var empty;var model=getOrCreateModel();if(scope.form&&scope.form.schema&&scope.form.schema.items){var items=scope.form.schema.items;if(items.type&&items.type.indexOf("object")!==-1){empty={};if(!scope.options||scope.options.setSchemaDefaults!==false){empty=_angular2.default.isDefined(items["default"])?items["default"]:empty;if(empty){schemaForm.traverseSchema(items,function(prop,path){if(_angular2.default.isDefined(prop["default"])){sel(path,empty,prop["default"])}})}}}else if(items.type&&items.type.indexOf("array")!==-1){empty=[];if(!scope.options||scope.options.setSchemaDefaults!==false){empty=items["default"]||empty}}else{if(!scope.options||scope.options.setSchemaDefaults!==false){empty=items["default"]||empty}}}model.push(empty);return model};scope.deleteFromArray=function(index){var model=scope.modelArray;if(model){model.splice(index,1)}return model};var setIndex=function setIndex(index){return function(form){if(form.key){form.key[form.key.indexOf("")]=index}}};var formDefCache={};scope.copyWithIndex=function(index){var form=scope.form;if(!formDefCache[index]){var subForm=form.items[0];if(form.items.length>1){subForm={type:"section",items:form.items.map(function(item){item.ngModelOptions=form.ngModelOptions;if(_angular2.default.isUndefined(item.readonly)){item.readonly=form.readonly}return item})}}if(subForm){var copy=_angular2.default.copy(subForm);copy.arrayIndex=index;schemaForm.traverseForm(copy,setIndex(index));formDefCache[index]=copy}}return formDefCache[index]}}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function($compile,$http,$templateCache,$q,schemaForm,schemaFormDecorators,sfSelect,sfPath,sfBuilder){return{scope:{schema:"=sfSchema",initialForm:"=sfForm",model:"=sfModel",options:"=sfOptions"},controller:["$scope",function($scope){this.evalInParentScope=function(expr,locals){return $scope.$parent.$eval(expr,locals)};var that=this;$scope.lookup=function(lookup){if(lookup){that.lookup=lookup}return that.lookup}}],replace:false,restrict:"A",transclude:true,require:"?form",link:function link(scope,element,attrs,formCtrl,transclude){scope.formCtrl=formCtrl;var ignore={};transclude(scope,function(clone){clone.addClass("schema-form-ignore");element.prepend(clone);if(element[0].querySelectorAll){var models=element[0].querySelectorAll("[ng-model]");if(models){for(var i=0;i<models.length;i++){var key=models[i].getAttribute("ng-model");ignore[key.substring(key.indexOf(".")+1)]=true}}}});var lastDigest={};var childScope;var render=function render(schema,form){var asyncTemplates=[];var merged=schemaForm.merge(schema,form,ignore,scope.options,undefined,asyncTemplates);if(asyncTemplates.length>0){$q.all(asyncTemplates.map(function(form){return $http.get(form.templateUrl,{cache:$templateCache}).then(function(res){form.template=res.data})})).then(function(){internalRender(schema,form,merged)})}else{internalRender(schema,form,merged)}};var internalRender=function internalRender(schema,form,merged){if(childScope){scope.externalDestructionInProgress=true;childScope.$destroy();scope.externalDestructionInProgress=false}childScope=scope.$new();childScope.schemaForm={form:merged,schema:schema};element.children(":not(.schema-form-ignore)").remove();var slots={};var slotsFound=element[0].querySelectorAll("*[sf-insert-field]");for(var i=0;i<slotsFound.length;i++){slots[slotsFound[i].getAttribute("sf-insert-field")]=slotsFound[i]}var decorator=schemaFormDecorators.decorator(attrs.sfUseDecorator);var lookup=Object.create(null);scope.lookup(lookup);element[0].appendChild(sfBuilder.build(merged,decorator,slots,lookup));childScope.firstDigest=true;setTimeout(function(){childScope.firstDigest=false},0);$compile(element.children())(childScope);if(!scope.options||scope.options.setSchemaDefaults!==false){schemaForm.traverseSchema(schema,function(prop,path){if(_angular2.default.isDefined(prop["default"])){var val=sfSelect(path,scope.model);if(_angular2.default.isUndefined(val)){sfSelect(path,scope.model,prop["default"])}}})}scope.$emit("sf-render-finished",element)};var defaultForm=["*"];scope.$watch(function(){var schema=scope.schema;var form=scope.initialForm||defaultForm;if(form&&schema&&schema.type&&(lastDigest.form!==form||lastDigest.schema!==schema)&&Object.keys(schema.properties).length>0){lastDigest.schema=schema;lastDigest.form=form;render(schema,form)}});scope.$on("schemaFormRedraw",function(){var schema=scope.schema;var form=scope.initialForm||["*"];if(schema){render(schema,form)}});scope.$on("$destroy",function(){scope.externalDestructionInProgress=true});scope.evalExpr=function(expression,locals){return scope.$parent.$eval(expression,locals)}}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(sfValidator,$parse,sfSelect){return{restrict:"A",scope:false,priority:500,require:"ngModel",link:function link(scope,element,attrs,ngModel){scope.$emit("schemaFormPropagateNgModelController",ngModel);var error=null;var form=scope.$eval(attrs.schemaValidate);if(form.copyValueTo){ngModel.$viewChangeListeners.push(function(){var paths=form.copyValueTo;_angular2.default.forEach(paths,function(path){sfSelect(path,scope.model,ngModel.$modelValue)})})}var validate=function validate(viewValue){if(!form){return viewValue}if(scope.options&&scope.options.tv4Validation===false){return viewValue}var result=sfValidator.validate(form,viewValue);Object.keys(ngModel.$error).filter(function(k){return k.indexOf("tv4-")===0}).forEach(function(k){ngModel.$setValidity(k,true)});if(!result.valid){ngModel.$setValidity("tv4-"+result.error.code,false);error=result.error;if(ngModel.$validators){return viewValue}return undefined}return viewValue};if(typeof form.ngModel==="function"){form.ngModel(ngModel)}["$parsers","$viewChangeListeners","$formatters"].forEach(function(attr){if(form[attr]&&ngModel[attr]){form[attr].forEach(function(fn){ngModel[attr].push(fn)})}});["$validators","$asyncValidators"].forEach(function(attr){if(form[attr]&&ngModel[attr]){_angular2.default.forEach(form[attr],function(fn,name){ngModel[attr][name]=fn})}});ngModel.$parsers.push(validate);if(ngModel.$validators){ngModel.$validators.schemaForm=function(){return!Object.keys(ngModel.$error).some(function(e){return e!=="schemaForm"})}}var schema=form.schema;scope.validateField=function(){if(schema&&schema.type.indexOf("array")!==-1){validate(ngModel.$modelValue)}if(ngModel.$setDirty){ngModel.$setDirty();ngModel.$setViewValue(ngModel.$viewValue);ngModel.$commitViewValue();if(form.type==="checkbox"){if(form.required&&ngModel.$modelValue===undefined){ngModel.$setValidity("tv4-302",false)}}else if(form.required&&ngModel.$isEmpty(ngModel.$modelValue)){ngModel.$setValidity("tv4-302",false)}}else{ngModel.$setViewValue(ngModel.$viewValue)}};ngModel.$formatters.push(function(val){if(ngModel.$pristine&&scope.firstDigest&&(!scope.options||scope.options.validateOnRender!==true)){return val}validate(ngModel.$modelValue);return val});scope.$on("schemaFormValidate",scope.validateField);scope.schemaError=function(){return error}}}};var _angular=__webpack_require__(2);var _angular2=_interopRequireDefault(_angular);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}}])});